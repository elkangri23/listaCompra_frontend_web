{
  "info": {
    "name": "Lista Compra API",
    "description": "Colecci√≥n Postman v2.0.0 - 57 endpoints cubriendo autenticaci√≥n, gesti√≥n colaborativa, inteligencia artificial, plantillas, administraci√≥n avanzada y observabilidad de cach√©.",
    "version": "2.0.0",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "auth": {
    "type": "bearer",
    "bearer": [
      {
        "key": "token",
        "value": "{{token}}",
        "type": "string"
      }
    ]
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:3000/api/v1",
      "type": "string"
    },
    {
      "key": "token",
      "value": "",
      "type": "string"
    },
    {
      "key": "userId",
      "value": "",
      "type": "string"
    },
    {
      "key": "listId",
      "value": "",
      "type": "string"
    },
    {
      "key": "productId",
      "value": "",
      "type": "string"
    },
    {
      "key": "categoryId",
      "value": "",
      "type": "string"
    },
    {
      "key": "storeId",
      "value": "",
      "type": "string"
    },
    {
      "key": "invitationHash",
      "value": "",
      "type": "string"
    },
    {
      "key": "targetUserId",
      "value": "",
      "type": "string",
      "description": "ID del colaborador cuyo permiso se actualiza"
    },
    {
      "key": "invitationId",
      "value": "",
      "type": "string",
      "description": "ID de la invitaci√≥n a cancelar"
    },
    {
      "key": "adminSessionId",
      "value": "",
      "type": "string",
      "description": "ID opcional de la sesi√≥n de impersonaci√≥n"
    },
    {
      "key": "blueprintId",
      "value": "",
      "type": "string",
      "description": "ID del blueprint a consultar"
    }
  ],
  "item": [
    {
      "name": "01. Autenticaci√≥n",
      "item": [
        {
          "name": "Registrar Usuario",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"usuario@ejemplo.com\",\n  \"password\": \"MiPassword123!\",\n  \"nombre\": \"Juan\",\n  \"apellidos\": \"P√©rez Garc√≠a\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/register",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "auth",
                "register"
              ]
            },
            "description": "Registra un nuevo usuario en el sistema. La contrase√±a debe tener al menos 8 caracteres, 1 may√∫scula, 1 min√∫scula y 1 n√∫mero."
          },
          "response": []
        },
        {
          "name": "Login",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    if (response.success && response.data.tokens) {",
                  "        pm.collectionVariables.set('token', response.data.tokens.accessToken);",
                  "        pm.collectionVariables.set('userId', response.data.user.id);",
                  "        console.log('Token de acceso guardado:', response.data.tokens.accessToken);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"usuario@ejemplo.com\",\n  \"password\": \"MiPassword123!\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/login",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "auth",
                "login"
              ]
            },
            "description": "Autentica un usuario y devuelve tokens de acceso. El token se guarda autom√°ticamente en las variables de colecci√≥n."
          },
          "response": []
        },
        {
          "name": "Obtener Perfil Usuario",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/auth/me",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "auth",
                "me"
              ]
            },
            "description": "Obtiene la informaci√≥n del usuario autenticado actual."
          },
          "response": []
        },
        {
          "name": "Refresh Token",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"refreshToken\": \"refresh_token_aqui\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/refresh",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "auth",
                "refresh"
              ]
            },
            "description": "Renueva un token de acceso usando el refresh token. (Pendiente de implementar)"
          },
          "response": []
        },
        {
          "name": "Logout",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/auth/logout",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "auth",
                "logout"
              ]
            },
            "description": "Cierra la sesi√≥n del usuario actual."
          },
          "response": []
        }
      ]
    },
    {
      "name": "02. Listas de Compra",
      "item": [
        {
          "name": "Crear Lista",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    if (response.success && response.data.id) {",
                  "        pm.collectionVariables.set('listId', response.data.id);",
                  "        console.log('ID de lista guardado:', response.data.id);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nombre\": \"Lista de la compra semanal\",\n  \"descripcion\": \"Compras para la semana del 28 de octubre\",\n  \"tiendaId\": \"{{storeId}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/lists",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "lists"
              ]
            },
            "description": "Crea una nueva lista de compra. Opcionalmente se puede asociar a una tienda espec√≠fica."
          },
          "response": []
        },
        {
          "name": "Obtener Mis Listas",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/lists?page=1&limit=10",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "lists"
              ],
              "query": [
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "10"
                }
              ]
            },
            "description": "Obtiene todas las listas del usuario autenticado con paginaci√≥n."
          },
          "response": []
        },
        {
          "name": "Obtener Lista por ID",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/lists/{{listId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "lists",
                "{{listId}}"
              ]
            },
            "description": "Obtiene los detalles de una lista espec√≠fica por su ID."
          },
          "response": []
        },
        {
          "name": "Actualizar Lista",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nombre\": \"Lista de la compra semanal - Actualizada\",\n  \"descripcion\": \"Lista actualizada para incluir productos extra\",\n  \"tiendaId\": \"{{storeId}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/lists/{{listId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "lists",
                "{{listId}}"
              ]
            },
            "description": "Actualiza los datos de una lista existente. Solo el propietario puede hacerlo."
          },
          "response": []
        },
        {
          "name": "Eliminar Lista",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/lists/{{listId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "lists",
                "{{listId}}"
              ]
            },
            "description": "Elimina permanentemente una lista y todos sus productos. Solo el propietario puede hacerlo."
          },
          "response": []
        }
      ]
    },
    {
      "name": "03. Productos",
      "item": [
        {
          "name": "Agregar Producto a Lista",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    if (response.success && response.data.id) {",
                  "        pm.collectionVariables.set('productId', response.data.id);",
                  "        console.log('ID de producto guardado:', response.data.id);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nombre\": \"Manzanas Fuji\",\n  \"descripcion\": \"Manzanas frescas para la semana\",\n  \"cantidad\": 2,\n  \"unidad\": \"kg\",\n  \"precio\": 3.50,\n  \"urgente\": false,\n  \"categoriaId\": \"{{categoryId}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/lists/{{listId}}/products",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "lists",
                "{{listId}}",
                "products"
              ]
            },
            "description": "Agrega un nuevo producto a una lista espec√≠fica."
          },
          "response": []
        },
        {
          "name": "Obtener Productos de Lista",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/lists/{{listId}}/products?comprado=false&page=1&limit=20",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "lists",
                "{{listId}}",
                "products"
              ],
              "query": [
                {
                  "key": "comprado",
                  "value": "false",
                  "description": "Filtrar por estado de comprado"
                },
                {
                  "key": "urgente",
                  "value": "true",
                  "disabled": true
                },
                {
                  "key": "categoriaId",
                  "value": "{{categoryId}}",
                  "disabled": true
                },
                {
                  "key": "busqueda",
                  "value": "manzana",
                  "disabled": true
                },
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "20"
                }
              ]
            },
            "description": "Obtiene todos los productos de una lista con filtros opcionales."
          },
          "response": []
        },
        {
          "name": "Marcar Producto como Comprado",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"comprado\": true\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/lists/{{listId}}/products/{{productId}}/purchased",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "lists",
                "{{listId}}",
                "products",
                "{{productId}}",
                "purchased"
              ]
            },
            "description": "Marca o desmarca un producto como comprado."
          },
          "response": []
        },
        {
          "name": "Actualizar Producto",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nombre\": \"Manzanas Golden - Actualizado\",\n  \"descripcion\": \"Manzanas golden en lugar de fuji\",\n  \"cantidad\": 3,\n  \"unidad\": \"kg\",\n  \"precio\": 2.80,\n  \"urgente\": true,\n  \"categoriaId\": \"{{categoryId}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/lists/{{listId}}/products/{{productId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "lists",
                "{{listId}}",
                "products",
                "{{productId}}"
              ]
            },
            "description": "Actualiza la informaci√≥n de un producto existente."
          },
          "response": []
        },
        {
          "name": "Eliminar Producto",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/lists/{{listId}}/products/{{productId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "lists",
                "{{listId}}",
                "products",
                "{{productId}}"
              ]
            },
            "description": "Elimina un producto de la lista permanentemente."
          },
          "response": []
        }
      ]
    },
    {
      "name": "04. Categor√≠as",
      "item": [
        {
          "name": "Crear Categor√≠a",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    if (response.success && response.data.id) {",
                  "        pm.collectionVariables.set('categoryId', response.data.id);",
                  "        console.log('ID de categor√≠a guardado:', response.data.id);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nombre\": \"Frutas y Verduras\",\n  \"descripcion\": \"Productos frescos del huerto\",\n  \"color\": \"#4CAF50\",\n  \"icono\": \"üçé\",\n  \"tiendaId\": \"{{storeId}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/categories",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "categories"
              ]
            },
            "description": "Crea una nueva categor√≠a personalizada para organizar productos."
          },
          "response": []
        },
        {
          "name": "Obtener Categor√≠as por Tienda",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/categories?tiendaId={{storeId}}&activas=true",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "categories"
              ],
              "query": [
                {
                  "key": "tiendaId",
                  "value": "{{storeId}}"
                },
                {
                  "key": "activas",
                  "value": "true"
                }
              ]
            },
            "description": "Obtiene todas las categor√≠as disponibles para una tienda espec√≠fica."
          },
          "response": []
        },
        {
          "name": "Actualizar Categor√≠a",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nombre\": \"Frutas y Verduras Frescas\",\n  \"descripcion\": \"Productos frescos y ecol√≥gicos\",\n  \"color\": \"#8BC34A\",\n  \"icono\": \"ü•ï\",\n  \"activa\": true\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/categories/{{categoryId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "categories",
                "{{categoryId}}"
              ]
            },
            "description": "Actualiza una categor√≠a existente. Solo el creador puede hacerlo."
          },
          "response": []
        },
        {
          "name": "Eliminar Categor√≠a",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/categories/{{categoryId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "categories",
                "{{categoryId}}"
              ]
            },
            "description": "Elimina una categor√≠a. No se puede eliminar si tiene productos asociados."
          },
          "response": []
        },
        {
          "name": "Toggle Estado Categor√≠a",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/categories/{{categoryId}}/toggle-status",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "categories",
                "{{categoryId}}",
                "toggle-status"
              ]
            },
            "description": "Activa o desactiva una categor√≠a existente.",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"activa\": false\n}"
            }
          },
          "response": []
        },
        {
          "name": "Mover Categor√≠a a Otra Tienda",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/categories/{{categoryId}}/move-to-store",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "categories",
                "{{categoryId}}",
                "move-to-store"
              ]
            },
            "description": "Reasigna una categor√≠a a una tienda diferente.",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"tiendaId\": \"{{storeId}}\"\n}"
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "05. Tiendas",
      "item": [
        {
          "name": "Crear Tienda",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    if (response.success && response.data.id) {",
                  "        pm.collectionVariables.set('storeId', response.data.id);",
                  "        console.log('ID de tienda guardado:', response.data.id);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nombre\": \"Mercadona Centro\",\n  \"direccion\": \"Calle Principal 123, Madrid\",\n  \"telefono\": \"+34 912 345 678\",\n  \"sitioWeb\": \"https://mercadona.es\",\n  \"tipo\": \"supermercado\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/stores",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "stores"
              ]
            },
            "description": "Crea una nueva tienda en el sistema."
          },
          "response": []
        },
        {
          "name": "Obtener Todas las Tiendas",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/stores?page=1&limit=20&activas=true",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "stores"
              ],
              "query": [
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "20"
                },
                {
                  "key": "tipo",
                  "value": "supermercado",
                  "disabled": true
                },
                {
                  "key": "activas",
                  "value": "true"
                },
                {
                  "key": "search",
                  "value": "mercadona",
                  "disabled": true
                }
              ]
            },
            "description": "Obtiene la lista de todas las tiendas disponibles con filtros opcionales."
          },
          "response": []
        },
        {
          "name": "Obtener Tienda por ID",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/stores/{{storeId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "stores",
                "{{storeId}}"
              ]
            },
            "description": "Obtiene los detalles de una tienda espec√≠fica."
          },
          "response": []
        },
        {
          "name": "Actualizar Tienda",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nombre\": \"Mercadona Centro - Renovado\",\n  \"direccion\": \"Calle Principal 123, Madrid (entrada renovada)\",\n  \"telefono\": \"+34 912 345 679\",\n  \"sitioWeb\": \"https://mercadona.es\",\n  \"tipo\": \"supermercado\",\n  \"activa\": true\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/stores/{{storeId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "stores",
                "{{storeId}}"
              ]
            },
            "description": "Actualiza la informaci√≥n de una tienda existente."
          },
          "response": []
        },
        {
          "name": "Eliminar Tienda",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/stores/{{storeId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "stores",
                "{{storeId}}"
              ]
            },
            "description": "Elimina una tienda del sistema."
          },
          "response": []
        },
        {
          "name": "Toggle Estado Tienda",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/stores/{{storeId}}/toggle-status",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "stores",
                "{{storeId}}",
                "toggle-status"
              ]
            },
            "description": "Activa o desactiva una tienda en el sistema.",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"activa\": false\n}"
            }
          },
          "response": []
        },
        {
          "name": "Obtener Categor√≠as de Tienda",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/stores/{{storeId}}/categories",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "stores",
                "{{storeId}}",
                "categories"
              ]
            },
            "description": "Lista las categor√≠as asociadas a una tienda espec√≠fica."
          },
          "response": []
        }
      ]
    },
    {
      "name": "06. Invitaciones & Permisos",
      "item": [
        {
          "name": "Compartir Lista",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    if (response.success && response.data.hash) {",
                  "        pm.collectionVariables.set('invitationHash', response.data.hash);",
                  "        console.log('Hash de invitaci√≥n guardado:', response.data.hash);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"invitado@ejemplo.com\",\n  \"permiso\": \"lectura-escritura\",\n  \"mensaje\": \"Te invito a colaborar en mi lista de la compra semanal\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/invitations/{{listId}}/share",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "invitations",
                "{{listId}}",
                "share"
              ]
            },
            "description": "Crea una invitaci√≥n para compartir una lista con otro usuario."
          },
          "response": []
        },
        {
          "name": "Acceder a Lista Compartida",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/invitations/{{invitationHash}}/access",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "invitations",
                "{{invitationHash}}",
                "access"
              ]
            },
            "description": "Accede a una lista compartida usando el hash de invitaci√≥n. No requiere autenticaci√≥n."
          },
          "response": []
        },
        {
          "name": "Obtener Invitaciones de Lista",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/invitations/{{listId}}/list",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "invitations",
                "{{listId}}",
                "list"
              ]
            },
            "description": "Obtiene todas las invitaciones activas de una lista. Solo el propietario puede hacerlo."
          },
          "response": []
        },
        {
          "name": "Actualizar Permisos de Invitaci√≥n",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nuevoTipoPermiso\": \"ESCRITURA\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/invitations/{{listId}}/permissions/{{targetUserId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "invitations",
                "{{listId}}",
                "permissions",
                "{{targetUserId}}"
              ]
            },
            "description": "Actualiza el tipo de permiso asignado a un colaborador espec√≠fico."
          },
          "response": []
        },
        {
          "name": "Cancelar Invitaci√≥n",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/invitations/{{invitationId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "invitations",
                "{{invitationId}}"
              ]
            },
            "description": "Cancela una invitaci√≥n pendiente usando su ID."
          },
          "response": []
        },
        {
          "name": "Listar Permisos de Lista",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/invitations/{{listId}}/permissions",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "invitations",
                "{{listId}}",
                "permissions"
              ]
            },
            "description": "Recupera todos los permisos otorgados para la lista indicada."
          },
          "response": []
        },
        {
          "name": "Revocar Permiso de Colaborador",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/invitations/{{listId}}/permissions/{{targetUserId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "invitations",
                "{{listId}}",
                "permissions",
                "{{targetUserId}}"
              ]
            },
            "description": "Revoca el acceso de un colaborador espec√≠fico a la lista."
          },
          "response": []
        }
      ]
    },
    {
      "name": "07. Inteligencia Artificial (IA Core)",
      "item": [
        {
          "name": "Sugerencias de Categor√≠as (CU-28)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/ai/category-suggestions",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "ai",
                "category-suggestions"
              ]
            },
            "description": "Solicita sugerencias de categor√≠as para un producto utilizando IA.",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"productName\": \"Caf√© molido 250g\",\n  \"storeName\": \"Mercadona\",\n  \"existingCategories\": [\n    \"Bebidas\",\n    \"Desayuno\"\n  ]\n}"
            }
          },
          "response": []
        },
        {
          "name": "Categorizaci√≥n Masiva (CU-29)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200 || pm.response.code === 207) {",
                  "    const jsonData = pm.response.json();",
                  "    if (jsonData.success && jsonData.data.batchStats) {",
                  "        console.log('Categorizaci√≥n exitosa:');",
                  "        console.log('- Total productos:', jsonData.data.batchStats.totalProducts);",
                  "        console.log('- Exitosos:', jsonData.data.batchStats.successful);",
                  "        console.log('- Fallidos:', jsonData.data.batchStats.failed);",
                  "        console.log('- Desde cache:', jsonData.data.batchStats.fromCache);",
                  "        console.log('- Desde IA:', jsonData.data.batchStats.fromAI);",
                  "        console.log('- Confianza promedio:', jsonData.data.batchStats.averageConfidence);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"products\": [\n    {\n      \"nombre\": \"Leche entera Pascual 1L\",\n      \"descripcion\": \"Leche pasteurizada botella 1 litro\"\n    },\n    {\n      \"nombre\": \"Pan integral\"\n    },\n    {\n      \"nombre\": \"Coca Cola 2L\"\n    },\n    {\n      \"nombre\": \"Pechuga de pollo\",\n      \"descripcion\": \"Pollo fresco de granja\"\n    },\n    {\n      \"nombre\": \"Tomates cherry\"\n    }\n  ],\n  \"tiendaId\": \"{{storeId}}\",\n  \"enrichWithExistingCategories\": true\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/ai/bulk-categorize",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "ai",
                "bulk-categorize"
              ]
            },
            "description": "üÜï CU-29: Categoriza autom√°ticamente hasta 50 productos en un solo request usando IA (Perplexity Llama 3.1 Sonar). Caracter√≠sticas:\n\n- üì¶ **Batching inteligente**: Divisi√≥n autom√°tica en sub-lotes de 20 productos\n- üíæ **Cache Redis**: TTL 24h para reducir costos\n- üìä **Enriquecimiento BD**: Usa categor√≠as existentes de la tienda\n- üõ°Ô∏è **Validaci√≥n 3 niveles**: DTO Zod + Use Case + Service\n- üìà **Estad√≠sticas completas**: Confidence, sources, timing\n- ‚ö†Ô∏è **Fallos parciales**: C√≥digo 207 si algunos productos fallan\n- üîê **Rate Limiting**: 5 requests/hora por usuario\n\n**Par√°metros:**\n- `products` (array 1-50): Lista de productos con nombre (requerido) y descripci√≥n (opcional)\n- `tiendaId` (UUID opcional): Para enriquecer con categor√≠as de esa tienda\n- `enrichWithExistingCategories` (boolean, default true): Si usar categor√≠as de BD\n\n**Respuestas:**\n- `200 OK`: Todos los productos categorizados exitosamente\n- `207 Multi-Status`: Algunos productos fallaron (ver batchStats.failed)\n- `400 Bad Request`: Validaci√≥n fallida (>50 productos, nombres inv√°lidos, etc.)\n- `429 Too Many Requests`: Rate limit excedido (5 req/hora)\n\n**Ejemplo de respuesta:**\n```json\n{\n  \"success\": true,\n  \"data\": {\n    \"categorizedProducts\": [\n      {\n        \"nombre\": \"Leche entera Pascual 1L\",\n        \"suggestedCategory\": {\n          \"nombre\": \"L√°cteos\",\n          \"tiendaId\": \"uuid\",\n          \"confidence\": 95\n        },\n        \"alternativeCategories\": [{\"nombre\": \"Bebidas\", \"confidence\": 60}],\n        \"source\": \"ai\",\n        \"processingTimeMs\": 1250\n      }\n    ],\n    \"batchStats\": {\n      \"totalProducts\": 5,\n      \"successful\": 5,\n      \"failed\": 0,\n      \"fromCache\": 2,\n      \"fromAI\": 3,\n      \"averageConfidence\": 88.5,\n      \"totalProcessingTimeMs\": 3200,\n      \"estimatedTokens\": 450\n    }\n  }\n}\n```"
          },
          "response": []
        },
        {
          "name": "Health Check IA",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/ai/health",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "ai",
                "health"
              ]
            },
            "description": "Verifica el estado de salud del subsistema de IA."
          },
          "response": []
        },
        {
          "name": "Telemetr√≠a IA (Admin)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/ai/info",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "ai",
                "info"
              ]
            },
            "description": "Obtiene m√©tricas agregadas de uso de IA (requiere rol admin)."
          },
          "response": []
        }
      ]
    },
    {
      "name": "08. IA - Listas por Ocasi√≥n",
      "item": [
        {
          "name": "Obtener Ocasiones Disponibles",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/occasion-lists/occasions",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "occasion-lists",
                "occasions"
              ]
            },
            "description": "Obtiene la lista de 20 ocasiones predefinidas disponibles para generar listas inteligentes (barbacoa, cena rom√°ntica, etc.)."
          },
          "response": []
        },
        {
          "name": "Generar Lista por Ocasi√≥n",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const jsonData = pm.response.json();",
                  "    if (jsonData.data && jsonData.data.list && jsonData.data.list.id) {",
                  "        pm.environment.set('listId', jsonData.data.list.id);",
                  "        console.log('ListId guardado:', jsonData.data.list.id);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"occasion\": \"Barbacoa\",\n  \"numberOfPeople\": 8,\n  \"budget\": 150,\n  \"dietaryRestrictions\": [\"Sin gluten\"],\n  \"storeId\": \"{{storeId}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/occasion-lists/generate",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "occasion-lists",
                "generate"
              ]
            },
            "description": "Genera autom√°ticamente una lista completa de productos usando IA bas√°ndose en una ocasi√≥n espec√≠fica. Requiere: occasion (una de las 20 disponibles), numberOfPeople (1-50), budget (1-10000‚Ç¨). Opcional: dietaryRestrictions (m√°x 10), storeId."
          },
          "response": []
        },
        {
          "name": "Preview Lista por Ocasi√≥n",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"occasion\": \"Cena rom√°ntica\",\n  \"numberOfPeople\": 2,\n  \"budget\": 80\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/occasion-lists/preview",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "occasion-lists",
                "preview"
              ]
            },
            "description": "Genera un preview de lista por ocasi√≥n SIN guardarla en la base de datos. √ötil para ver qu√© productos sugerir√≠a la IA antes de crear la lista real. Mismos par√°metros que 'Generar Lista por Ocasi√≥n'."
          },
          "response": []
        }
      ]
    },
    {
      "name": "09. IA - Recomendaciones Contextuales",
      "item": [
        {
          "name": "Ejemplos de Contexto (P√∫blico)",
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/recommendations/context-examples",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "recommendations",
                "context-examples"
              ]
            },
            "description": "üìö Endpoint p√∫blico (sin autenticaci√≥n) que devuelve ejemplos de contextos √∫tiles para mejorar recomendaciones: 'Cena rom√°ntica', 'Barbacoa familiar', 'Desayuno fitness', etc. con tips de uso."
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status code es 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Respuesta tiene ejemplos', function () {",
                  "    const jsonData = pm.response.json();",
                  "    pm.expect(jsonData.success).to.eql(true);",
                  "    pm.expect(jsonData.data.examples).to.be.an('array');",
                  "    pm.expect(jsonData.data.examples.length).to.be.above(0);",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Recomendaciones Generales",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/recommendations/{{listId}}?creativityLevel=balanced&maxRecommendations=10&excludeExisting=true",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "recommendations",
                "{{listId}}"
              ],
              "query": [
                {
                  "key": "creativityLevel",
                  "value": "balanced",
                  "description": "Conservative (seguro) | Balanced (equilibrado) | Creative (innovador)"
                },
                {
                  "key": "maxRecommendations",
                  "value": "10",
                  "description": "Cantidad de sugerencias (5-50)"
                },
                {
                  "key": "excludeExisting",
                  "value": "true",
                  "description": "Excluir productos ya en lista"
                },
                {
                  "key": "context",
                  "value": "",
                  "description": "Contexto opcional: 'Cena italiana', 'Desayuno fitness'",
                  "disabled": true
                },
                {
                  "key": "categoryId",
                  "value": "",
                  "description": "Filtrar por categor√≠a espec√≠fica",
                  "disabled": true
                },
                {
                  "key": "includeUserHistory",
                  "value": "true",
                  "description": "Incluir historial de usuario",
                  "disabled": true
                }
              ]
            },
            "description": "üéØ Obtiene recomendaciones generales de productos complementarios para una lista completa. La IA analiza todos los productos actuales y sugiere items que complementan bien.\n\n**Niveles de creatividad:**\n- Conservative: Solo muy relacionados\n- Balanced: Mix equilibrado (recomendado)\n- Creative: Sugerencias innovadoras"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status code es 200 o 400 (lista vac√≠a)', function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([200, 400, 403, 404]);",
                  "});",
                  "",
                  "if (pm.response.code === 200) {",
                  "    pm.test('Respuesta tiene recomendaciones', function () {",
                  "        const jsonData = pm.response.json();",
                  "        pm.expect(jsonData.success).to.eql(true);",
                  "        pm.expect(jsonData.data).to.have.property('recommendations');",
                  "        pm.expect(jsonData.data).to.have.property('detectedContext');",
                  "        pm.expect(jsonData.data.metadata).to.have.property('averageConfidence');",
                  "    });",
                  "",
                  "    pm.test('Recomendaciones tienen estructura correcta', function () {",
                  "        const jsonData = pm.response.json();",
                  "        if (jsonData.data.recommendations.length > 0) {",
                  "            const rec = jsonData.data.recommendations[0];",
                  "            pm.expect(rec).to.have.property('name');",
                  "            pm.expect(rec).to.have.property('reason');",
                  "            pm.expect(rec).to.have.property('confidenceScore');",
                  "            pm.expect(rec).to.have.property('recommendationType');",
                  "        }",
                  "    });",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "Recomendaciones Espec√≠ficas por Producto",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/recommendations/{{listId}}/for-product/{{productId}}?creativityLevel=balanced&maxRecommendations=8",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "recommendations",
                "{{listId}}",
                "for-product",
                "{{productId}}"
              ],
              "query": [
                {
                  "key": "creativityLevel",
                  "value": "balanced"
                },
                {
                  "key": "maxRecommendations",
                  "value": "8"
                },
                {
                  "key": "context",
                  "value": "",
                  "description": "Contexto opcional para afinar sugerencias",
                  "disabled": true
                }
              ]
            },
            "description": "üîç Obtiene recomendaciones enfocadas en un producto espec√≠fico de la lista. Por ejemplo, si seleccionas 'Pasta', sugerir√° 'Salsa de tomate', 'Queso parmesano', 'Albahaca', etc.\n\n**Casos de uso:**\n- Complementar un producto que acabas de a√±adir\n- Ver qu√© va bien con un ingrediente espec√≠fico\n- Descubrir combinaciones que no conoc√≠as"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Status code v√°lido', function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([200, 400, 403, 404]);",
                  "});",
                  "",
                  "if (pm.response.code === 200) {",
                  "    pm.test('Recomendaciones relacionadas con producto', function () {",
                  "        const jsonData = pm.response.json();",
                  "        pm.expect(jsonData.data.recommendations).to.be.an('array');",
                  "        // Las recomendaciones deber√≠an incluir relatedProducts",
                  "        if (jsonData.data.recommendations.length > 0) {",
                  "            const rec = jsonData.data.recommendations[0];",
                  "            pm.expect(rec).to.have.property('relatedProducts');",
                  "        }",
                  "    });",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "Recomendaciones con Contexto Espec√≠fico",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/recommendations/{{listId}}?context=Cena italiana&creativityLevel=creative&maxRecommendations=12",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "recommendations",
                "{{listId}}"
              ],
              "query": [
                {
                  "key": "context",
                  "value": "Cena italiana",
                  "description": "Contexto para afinar recomendaciones"
                },
                {
                  "key": "creativityLevel",
                  "value": "creative"
                },
                {
                  "key": "maxRecommendations",
                  "value": "12"
                }
              ]
            },
            "description": "üé® Ejemplo de recomendaciones con contexto espec√≠fico. El contexto ayuda a la IA a entender mejor la ocasi√≥n y sugerir productos m√°s apropiados.\n\n**Ejemplos de contextos:**\n- 'Cena italiana' ‚Üí Sugerir√° vino, pan, postre italiano\n- 'Desayuno fitness' ‚Üí Frutas, yogurt, avena\n- 'Barbacoa familiar' ‚Üí Carb√≥n, salsas, bebidas\n- 'Cena rom√°ntica' ‚Üí Velas, vino premium, postre"
          },
          "response": []
        },
        {
          "name": "Recomendaciones por Categor√≠a",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/recommendations/{{listId}}?categoryId={{categoryId}}&maxRecommendations=15",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "recommendations",
                "{{listId}}"
              ],
              "query": [
                {
                  "key": "categoryId",
                  "value": "{{categoryId}}",
                  "description": "Filtrar solo esta categor√≠a"
                },
                {
                  "key": "maxRecommendations",
                  "value": "15"
                }
              ]
            },
            "description": "üóÇÔ∏è Filtra recomendaciones para obtener solo productos de una categor√≠a espec√≠fica. √ötil cuando quieres completar una secci√≥n particular de tu lista.\n\n**Ejemplo:**\nSi tienes productos de 'Verduras' y filtras por categoryId de 'Verduras', obtendr√°s m√°s sugerencias de vegetales que complementen los que ya tienes."
          },
          "response": []
        }
      ]
    },
    {
      "name": "10. Blueprints / Plantillas",
      "item": [
        {
          "name": "Crear Blueprint",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/blueprints",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "blueprints"
              ]
            },
            "description": "Crea un blueprint privado a partir de la lista actual.",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nombre\": \"Lista semanal saludable\",\n  \"descripcion\": \"Plantilla base para compras saludables\",\n  \"productos\": [\n    {\n      \"nombre\": \"Manzanas\",\n      \"cantidad\": 6\n    },\n    {\n      \"nombre\": \"Pollo\",\n      \"cantidad\": 2,\n      \"categoriaId\": \"{{categoryId}}\"\n    }\n  ]\n}"
            }
          },
          "response": []
        },
        {
          "name": "Mis Blueprints",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/blueprints",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "blueprints"
              ]
            },
            "description": "Obtiene los blueprints creados por el usuario autenticado."
          },
          "response": []
        },
        {
          "name": "Blueprints P√∫blicos",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/blueprints/publicos",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "blueprints",
                "publicos"
              ],
              "query": [
                {
                  "key": "pagina",
                  "value": "1"
                },
                {
                  "key": "limite",
                  "value": "10"
                }
              ]
            },
            "description": "Lista blueprints p√∫blicos con filtros opcionales."
          },
          "response": []
        },
        {
          "name": "Buscar Blueprints",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/blueprints/buscar",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "blueprints",
                "buscar"
              ],
              "query": [
                {
                  "key": "q",
                  "value": "asado"
                },
                {
                  "key": "pagina",
                  "value": "1"
                }
              ]
            },
            "description": "Busca blueprints por nombre o descripci√≥n."
          },
          "response": []
        },
        {
          "name": "Detalle Blueprint",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/blueprints/{{blueprintId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "blueprints",
                "{{blueprintId}}"
              ]
            },
            "description": "Obtiene el detalle completo de un blueprint espec√≠fico."
          },
          "response": []
        },
        {
          "name": "Actualizar Blueprint",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/blueprints/{{blueprintId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "blueprints",
                "{{blueprintId}}"
              ]
            },
            "description": "Actualiza nombre, descripci√≥n y productos de un blueprint.",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nombre\": \"Lista semanal actualizada\",\n  \"descripcion\": \"Versi√≥n optimizada\",\n  \"publico\": true,\n  \"productos\": [\n    {\n      \"nombre\": \"Arroz integral\",\n      \"cantidad\": 2\n    },\n    {\n      \"nombre\": \"At√∫n\",\n      \"cantidad\": 4\n    }\n  ]\n}"
            }
          },
          "response": []
        },
        {
          "name": "Eliminar Blueprint",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/blueprints/{{blueprintId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "blueprints",
                "{{blueprintId}}"
              ]
            },
            "description": "Elimina un blueprint del usuario."
          },
          "response": []
        },
        {
          "name": "Crear Lista desde Blueprint",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/blueprints/{{blueprintId}}/crear-lista",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "blueprints",
                "{{blueprintId}}",
                "crear-lista"
              ]
            },
            "description": "Genera una nueva lista basada en el blueprint seleccionado.",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nombreLista\": \"Compra semanal desde blueprint\",\n  \"tiendaId\": \"{{storeId}}\"\n}"
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "11. üõ°Ô∏è Admin & Security",
      "item": [
        {
          "name": "Iniciar Impersonaci√≥n",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/admin/impersonate",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "admin",
                "impersonate"
              ]
            },
            "description": "Permite a un administrador impersonar a otro usuario por ID o email.",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"targetUserEmail\": \"usuario@cliente.com\",\n  \"reason\": \"Soporte t√©cnico\",\n  \"durationMinutes\": 30\n}"
            }
          },
          "response": []
        },
        {
          "name": "Security Test - Vulnerability Scan",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/admin/security/test",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "admin",
                "security",
                "test"
              ]
            },
            "description": "üîç **Endpoint de Testing de Seguridad Autom√°tico**\n\n**Ejecuta una suite completa de tests de vulnerabilidades:**\n- ‚úÖ XSS Pattern Detection (6 vectores)\n- ‚úÖ SQL Injection Detection (7 vectores)\n- ‚úÖ Rate Limiting Validation\n- ‚úÖ Security Headers Verification\n- ‚úÖ HTTPS/SSL Configuration Check\n- ‚úÖ Authentication Security Audit\n- ‚úÖ Database Security Review\n\n**Response incluye:**\n- üìä Security Score (0-100)\n- üìà Total tests ejecutados\n- ‚ùå Tests fallidos con recomendaciones\n- üìã Reporte detallado por severidad\n\n**‚ö†Ô∏è SOLO ADMINISTRADORES**\nRequiere rol 'admin' para acceder."
          },
          "response": []
        },
        {
          "name": "Estado de Impersonaci√≥n",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/admin/impersonate/status",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "admin",
                "impersonate",
                "status"
              ]
            },
            "description": "Devuelve si existe una sesi√≥n de impersonaci√≥n activa."
          },
          "response": []
        },
        {
          "name": "Finalizar Impersonaci√≥n",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/admin/impersonate",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "admin",
                "impersonate"
              ]
            },
            "description": "Termina la sesi√≥n de impersonaci√≥n actual.",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"sessionId\": \"{{adminSessionId}}\",\n  \"reason\": \"Incidencia resuelta\"\n}"
            }
          },
          "response": []
        },
        {
          "name": "Auditor√≠a de Impersonaciones",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/admin/audit/impersonations",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "admin",
                "audit",
                "impersonations"
              ],
              "query": [
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "10"
                }
              ]
            },
            "description": "Lista el historial de sesiones de impersonaci√≥n."
          },
          "response": []
        }
      ]
    },
    {
      "name": "12. ‚ôªÔ∏è Cache Observability",
      "item": [
        {
          "name": "12.1 Cache Analytics",
          "item": [
            {
              "name": "Cache Analytics - Realtime",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/analytics/cache/realtime",
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "path": [
                    "analytics",
                    "cache",
                    "realtime"
                  ]
                },
                "description": "Obtiene m√©tricas en tiempo real del cache Redis."
              },
              "response": []
            },
            {
              "name": "Cache Analytics - Daily Metrics",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/analytics/cache/daily",
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "path": [
                    "analytics",
                    "cache",
                    "daily"
                  ]
                },
                "description": "M√©tricas agregadas de las √∫ltimas 24 horas."
              },
              "response": []
            },
            {
              "name": "Cache Analytics - Optimization Report",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/analytics/cache/optimization",
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "path": [
                    "analytics",
                    "cache",
                    "optimization"
                  ]
                },
                "description": "Genera recomendaciones de optimizaci√≥n de cache."
              },
              "response": []
            },
            {
              "name": "Cache Analytics - Dashboard Dataset",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/analytics/cache/dashboard",
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "path": [
                    "analytics",
                    "cache",
                    "dashboard"
                  ]
                },
                "description": "Devuelve datos formateados para dashboards de monitoreo."
              },
              "response": []
            },
            {
              "name": "Cache Analytics - Health",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/analytics/cache/health",
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "path": [
                    "analytics",
                    "cache",
                    "health"
                  ]
                },
                "description": "Verifica el estado general del sistema de cache."
              },
              "response": []
            }
          ]
        },
        {
          "name": "12.2 Cache Integrity (Admin)",
          "item": [
            {
              "name": "Cache Integrity - Scan",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{token}}"
                  }
                ],
                "url": {
                  "raw": "{{baseUrl}}/admin/cache/integrity/scan",
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "path": [
                    "admin",
                    "cache",
                    "integrity",
                    "scan"
                  ],
                  "query": [
                    {
                      "key": "pattern",
                      "value": "*"
                    }
                  ]
                },
                "description": "Escanea el cache en busca de datos corruptos."
              },
              "response": []
            },
            {
              "name": "Cache Integrity - Validate Key",
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{token}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "url": {
                  "raw": "{{baseUrl}}/admin/cache/integrity/validate",
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "path": [
                    "admin",
                    "cache",
                    "integrity",
                    "validate"
                  ]
                },
                "description": "Valida la integridad de una clave espec√≠fica.",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"key\": \"ai:category:leche\",\n  \"dataType\": \"ai_suggestion\"\n}"
                }
              },
              "response": []
            },
            {
              "name": "Cache Integrity - Stats",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{token}}"
                  }
                ],
                "url": {
                  "raw": "{{baseUrl}}/admin/cache/integrity/stats",
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "path": [
                    "admin",
                    "cache",
                    "integrity",
                    "stats"
                  ]
                },
                "description": "Obtiene m√©tricas agregadas de integridad de cache."
              },
              "response": []
            },
            {
              "name": "Cache Integrity - Cleanup",
              "request": {
                "method": "DELETE",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{token}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "url": {
                  "raw": "{{baseUrl}}/admin/cache/integrity/cleanup",
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "path": [
                    "admin",
                    "cache",
                    "integrity",
                    "cleanup"
                  ]
                },
                "description": "Elimina claves corruptas (usar dryRun en primera ejecuci√≥n).",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"pattern\": \"ai:*\",\n  \"dataType\": \"ai_suggestion\",\n  \"dryRun\": true\n}"
                }
              },
              "response": []
            },
            {
              "name": "Cache Integrity - Repair",
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Authorization",
                    "value": "Bearer {{token}}"
                  },
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "url": {
                  "raw": "{{baseUrl}}/admin/cache/integrity/repair",
                  "host": [
                    "{{baseUrl}}"
                  ],
                  "path": [
                    "admin",
                    "cache",
                    "integrity",
                    "repair"
                  ]
                },
                "description": "Repara claves espec√≠ficas regenerando su informaci√≥n.",
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"keys\": [\n    \"ai:category:leche\"\n  ],\n  \"dataType\": \"ai_suggestion\"\n}"
                }
              },
              "response": []
            }
          ]
        }
      ]
    },
    {
      "name": "13. Dashboard & Monitoring",
      "item": [
        {
          "name": "M√©tricas del Sistema",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/dashboard/metrics",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "dashboard",
                "metrics"
              ]
            },
            "description": "Obtiene m√©tricas completas del sistema: endpoints, cache y sistema."
          },
          "response": []
        },
        {
          "name": "Estado de Salud",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/dashboard/health",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "dashboard",
                "health"
              ]
            },
            "description": "Obtiene el estado de salud de los servicios del sistema."
          },
          "response": []
        },
        {
          "name": "Alertas Activas",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/dashboard/alerts",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "dashboard",
                "alerts"
              ]
            },
            "description": "Obtiene alertas activas del sistema (error rate, response time, cache)."
          },
          "response": []
        },
        {
          "name": "Performance Detallado",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/dashboard/performance",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "dashboard",
                "performance"
              ]
            },
            "description": "Obtiene an√°lisis detallado de performance: endpoints lentos y con errores."
          },
          "response": []
        }
      ]
    },
    {
      "name": "14. Dev Utilities (solo dev/test)",
      "item": [
        {
          "name": "Info Sistema de Eventos",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/dev/events",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "dev",
                "events"
              ]
            },
            "description": "Obtiene informaci√≥n sobre el estado del sistema de eventos RabbitMQ. Solo disponible en development."
          },
          "response": []
        },
        {
          "name": "Reset Sistema de Eventos",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/dev/events",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "dev",
                "events"
              ]
            },
            "description": "Reinicia el sistema de eventos para testing. Solo disponible en development."
          },
          "response": []
        },
        {
          "name": "Publicar Evento de Prueba",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"tipo\": \"TEST_EVENT\",\n  \"datos\": {\n    \"mensaje\": \"Evento de prueba desde Postman\",\n    \"timestamp\": \"2025-10-28T12:00:00Z\"\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/dev/events/test",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "dev",
                "events",
                "test"
              ]
            },
            "description": "Publica un evento de prueba para verificar el sistema de mensajer√≠a."
          },
          "response": []
        }
      ]
    }
  ]
}